{% extends 'base.html.twig' %}

{% block title %}Liste des rendez-vous
{% endblock %}

{% block body %}

	<div
		class="mt-4">

		<!-- HEADER -->
		<div class="card shadow-lg border-0 rounded-4 mb-4">
			<div class="card-body py-4 px-4">

				<div class="row align-items-center g-3">

					<div class="col-md-7 d-flex align-items-center">

						<div class="icon-circle bg-primary bg-opacity-10 text-primary me-3
							                        d-flex justify-content-center align-items-center" style="width:60px; height:60px; border-radius:16px;">
							<i class="bi bi-calendar-week fs-3"></i>
						</div>

						<div>
							<h2 class="fw-bold text-primary mb-1">Gestion des Rendez-vous</h2>
							<p class="text-muted mb-0">Planning complet des consultations</p>
						</div>

					</div>

					<div class="col-md-5 d-flex justify-content-md-end">
						<button type="button" onclick="history.back()" class="btn btn-outline-primary btn-lg rounded-pill px-4 shadow-sm d-flex align-items-center gap-2">
							<i class="bi bi-arrow-left"></i>
							Retour
						</button>
					</div>

				</div>

			</div>
		</div>

	</div>


	{% if rdvsByDay is empty %}
		<div class="alert alert-info text-center rounded-pill shadow-sm">
			Aucun rendez-vous trouvé.
		</div>
	{% endif %}

	<div class="row g-3">

		{% for day, items in rdvsByDay %}

			<!-- TITRE DU JOUR -->
			<h5 class="fw-bold text-primary mt-3 mb-2">
				<i class="bi bi-calendar-day me-2"></i>
				{{ day }}
			</h5>

			{% for rdv in items %}

				{% set statutColor = {
                'A venir': 'success',
                'Annulé': 'warning',
                'Passé': 'danger'
            }[rdv.statut|default('A venir')] ?? 'secondary' %}

				<div class="col-md-3 col-sm-6">
					<div class="card shadow-sm border-0 rounded-4" style="min-height: 165px;">

						<div class="card-body p-3">

							<div class="d-flex justify-content-between mb-2">
								<span class="badge bg-{{ statutColor }} px-2 py-1 rounded-pill">
									{{ rdv.statut|default('A venir') }}
								</span>

								<i class="bi bi-calendar-event fs-5 text-primary"></i>
							</div>

							<h6 class="fw-bold mb-1">
								<i class="bi bi-person-fill me-1"></i>
								{{ rdv.client.nom }}
							</h6>

							<p class="text-muted small mb-1">
								<i class="bi bi-clock me-1"></i>
								{{ rdv.dateRdvAt|date('H:i') }}
							</p>

							{% if rdv.motif %}
								<p class="small mb-1">
									<strong>Motif :</strong>
									{{ rdv.motif }}
								</p>
							{% endif %}

							<a href="{{ path('app_fiche_client_show', {id: rdv.client.id}) }}" class="btn btn-outline-primary btn-sm rounded-pill w-100 mt-2 shadow-sm">
								<i class="bi bi-eye"></i>
								Voir
							</a>

						</div>

					</div>
				</div>

			{% endfor %}

			<hr class="my-4">

		{% endfor %}

	</div>

{% endblock %}


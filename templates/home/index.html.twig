{% extends 'base.html.twig' %}

{% block title %}Accueil
{% endblock %}

{% block body %}

	<style>
		/* Effet hover premium */
		.dashboard-card {
			transition: all 0.25s ease-in-out;
			cursor: pointer;
		}

		.dashboard-card:hover {
			transform: translateY(-6px);
			box-shadow: 0 12px 22px rgba(0, 0, 0, 0.12) !important;
		}

		/* Badge visible et anim√© */
		.dashboard-badge {
			overflow: visible !important;
			animation: pulse 2s infinite;
			font-size: 0.70rem;
			padding: 6px 10px;
		}

		@keyframes pulse {
			0% {
				transform: scale(1);
			}
			50% {
				transform: scale(1.12);
			}
			100% {
				transform: scale(1);
			}
		}
		.separator {
    position: relative;
    padding: 10px 0;
}

.separator::before,
.separator::after {
    content: "";
    position: absolute;
    top: 50%;
    width: 40%;
    height: 1px;
    background: #d9d9d9;
}

.separator::before {
    left: 0;
}

.separator::after {
    right: 0;
}

	</style>

	<div class="container py-4">

<h4 class="fw-bold  text-left mb-4 mt-3">


	<i class="bi bi-activity text-primary me-2"></i>


Tableau de Bord ‚Äî

	<span id="nameCabinet"> </span>
</h4>




<div class="row g-4 justify-content-center row g-4 justify-content-center">




			<!-- ========================== -->
			<!-- üîπ 1 ‚Äî Ajouter un client  -->
			<!-- ========================== -->
<div class="col-12 col-md-3 my-bg">
<div class="card bg-gradient-success dashboard-card shadow border-0 rounded-4 text-center p-3">





<i class="bi bi-person-plus-fill text-success" style="font-size: 3.2rem;"></i>


<h5 class="mt-3 fw-bold text-success">Ajouter un patient</h5>



					<p class="text-muted small">Cr√©er une nouvelle fiche patient</p>

<button id="addClientHome" class="btn btn-success  btn-sm rounded-pill px-4 mt-2" data-bs-toggle="modal" data-bs-target="#modalAddClient">



						<i class="bi bi-plus-lg"></i>
						Ajouter
					</button>

				</div>
			</div>

			<!-- ========================== -->
			<!-- üîπ 2 ‚Äî Liste des clients  -->
			<!-- ========================== -->
<div class="col-12 col-md-3">
	<div class="card bg-gradient-primary dashboard-card shadow border-0 rounded-4 text-center p-3 position-relative">



					{% if totalClients is defined %}
						<span class="badge bg-info text-white position-absolute top-0 start-100 translate-middle dashboard-badge shadow">
							{{ totalClients }}
							
						</span>
					{% endif %}

					<i class="bi bi-people-fill text-primary" style="font-size: 3.2rem;"></i>

<h5 class="mt-3 fw-bold text-primary">Liste des clients</h5>


					<p class="text-muted small">G√©rer et consulter les patients</p>

<a id="listClientHome" class="btn btn-primary btn-sm rounded-pill px-4 mt-2" href="{{ path('app_fiche_client_index') }}">




						<i class="bi bi-search"></i>
Patients


					</a>

				</div>
			</div>

<!-- ========================== -->
<!-- üîπ 3 ‚Äî M√©dicaments -->
<!-- ========================== -->
<div class="col-12 col-md-3">
	<div class="card bg-gradient-danger dashboard-card shadow border-0 rounded-4 text-center p-3">



		<i class="bi bi-capsule-pill text-danger" style="font-size: 3.2rem;"></i>

<h5 class="mt-3 fw-bold text-danger">Liste des M√©dicaments</h5>


		<p class="text-muted small">Consultation & gestion des m√©dicaments</p>

<a href="{{ path('medicine_index') }}" class="btn btn-danger btn-sm rounded-pill px-4 mt-2">


			<i class="bi bi-prescription2"></i>
			Liste
		</a>

	</div>
</div>



			<!-- ========================== -->
			<!-- üîπ 4 ‚Äî Rendez-vous -->
			<!-- ========================== -->
<div class="col-12 col-md-3">
	<div class="card bg-gradient-info  dashboard-card shadow border-0 rounded-4 text-center p-3 position-relative">



					{% if totalRdv is defined %}
<span class="badge bg-info text-light position-absolute top-0 start-100 translate-middle dashboard-badge shadow">


							{{ totalRdv }}
							
						</span>
					{% endif %}

					<i class="bi bi-calendar-week text-info" style="font-size: 3.2rem;"></i>

<h5 class="mt-3 fw-bold text-info">Rendez-vous</h5>


					<p class="text-muted small">Consulter & g√©rer les RDV</p>

<a id="rdvClientHome" class="btn btn-info btn-sm rounded-pill px-4 mt-2 text-dark" href="{{ path('app_rdv_index') }}">




						<i class="bi bi-calendar-check"></i>
						Ouvrir
					</a>

				</div>
			</div>

		</div>

<div class="mt-5">
	<h4 class="fw-bold mb-3">
		<i class="bi bi-ui-checks-grid text-primary me-2"></i>
		R√©f√©rentiels & Ressources
	</h4>

	<div class="row g-3">

		<a href="{{ path('hopital_search_page') }}" class="col-md-4 text-decoration-none">
			<div class="p-3 border rounded-4 shadow-sm d-flex align-items-center">
				<i class="bi bi-hospital text-primary fs-3 me-3"></i>
				<div>
					<h6 class="fw-bold mb-0">√âtablissements Hospitaliers</h6>
					<small class="text-muted">Recherche & consultation</small>
				</div>
			</div>
		</a>


		<div class="col-md-4">
<a href="{{ path('hopital_search_page') }}" class="col-md-4 text-decoration-none">

			<div class="p-3 border rounded-4 shadow-sm d-flex align-items-center">
				<i class="bi bi-heart-pulse text-success fs-3 me-3"></i>
				<div>
					<h6 class="fw-bold mb-0">Dispositifs remboursables</h6>
					<small class="text-muted">CNOPS ‚Äì ANAM</small>
				</div>
			</div>
			</a>
		</div>

<div class="col-md-4">
<a href="{{ path('medicine_index') }}" class="col-md-4 text-decoration-none">


	<div class="p-3 border rounded-4 shadow-sm d-flex align-items-center">
<i class="bi bi-capsule-pill text-danger fs-3 me-3"></i>

		<div>
<h6 class="fw-bold mb-0">Liste des M√©dicaments</h6>

			<small class="text-muted">CNOPS ‚Äì ANAM</small>
		</div>
	</div>
</a>


</div>


	</div>
</div>
<div class="separator my-3 text-center">
	<i class="bi bi-heart-pulse-fill text-danger" style="font-size: 1.8rem;"></i>
</div>



		<!-- üìä SECTION STATISTIQUES -->
		{{ include('home/_stats/_stats.html.twig') }}
		

	</div>





	<!-- MODAL AJOUT PATIENT -->
	
	<div class="modal fade" id="modalAddClient" tabindex="-1">
			<div class="modal-dialog modal-xl">
				<div class="modal-content rounded-4 shadow-lg">

					<div class="modal-header bg-primary text-white rounded-top-4">
						<h5 class="modal-title fw-bold d-flex align-items-center">
							<i class="bi bi-person-plus fs-4 me-2"></i>
							Ajouter un patient
						</h5>
						<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
					</div>

					<div class="modal-body p-4">
{{ include('fiche_client/new.html.twig') }}



					</div>

				</div>
			</div>
		</div>


<script>
async function afficherNomCabinet() {

    const url = "{{ path('app_nom_cabinet') }}";
const urlConfig = "{{ path('app_cabinet_index') }}"; // üîß route vers la config du cabinet


    try {
        const response = await fetch(url);
        const data = await response.json();

        console.log("Nom cabinet :", data.nom);

        const element = document.getElementById('nameCabinet');
        if (!element) return; // S√©curit√©

        // Cas o√π le nom n'est pas d√©fini
        if (!data.nom || data.nom === "null") {

            element.innerHTML = `
                Veuillez configurer le nom du cabinet 
                <a href="${urlConfig}" class="btn btn-sm btn-warning ms-2">
                    Configurer
                </a>
            `;
        } 
        else {
            // Cabinet trouv√© ‚Üí affichage normal
            element.innerText = data.nom;
        }

    } catch (error) {
        console.error("Erreur :", error);
    }
}

// Ex√©cution
afficherNomCabinet();


		



</script>



{% endblock %}


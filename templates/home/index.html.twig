
{% extends 'base.html.twig' %}

{% block title %}Accueil
{% endblock %}

{% block body %}

	<style>
		/* =============================
   NEW DASHBOARD BLOCK STYLE PRO
   ============================= */

		.dashboard-pro {
			background: rgba(255, 255, 255, 0.65);
			backdrop-filter: blur(12px);
			border-radius: 18px;
			border: 1px solid rgba(255, 255, 255, 0.35);
			padding: 28px 20px;
			text-align: center;
			box-shadow: 0 8px 22px rgba(0, 0, 0, 0.06);
			transition: all 0.25s ease-in-out;
			cursor: pointer;
		}

		.dashboard-pro:hover {
			transform: translateY(-6px);
			box-shadow: 0 14px 28px rgba(0, 0, 0, 0.12);
		}

		/* Ic√¥ne principale */
		.dashboard-pro-icon {
			font-size: 3rem;
			padding: 18px;
			border-radius: 16px;
			display: inline-block;
			margin-bottom: 10px;
		}

		/* Titre */
		.dashboard-pro h5 {
			font-weight: 800;
			margin-top: 10px;
		}

		/* Sous-texte */
		.dashboard-pro p {
			color: #6c757d;
			font-size: 0.88rem;
		}

		/* Badge anim√© */
		.dashboard-pro-badge {
			position: absolute;
			top: -6px;
			right: -6px;
			background: #0dcaf0;
			color: white;
			font-weight: 700;
			padding: 6px 10px;
			border-radius: 50%;
			animation: pulse 2s infinite;
		}

		/* Animation du badge */
		@keyframes pulse {
			0% {
				transform: scale(1);
			}
			50% {
				transform: scale(1.12);
			}
			100% {
				transform: scale(1);
			}
		}

	</style>
	<div class="container py-4">
<div class="container my-4">


	<h4 class="fw-bold  text-left mb-4 mt-3">


		<i class="bi bi-activity text-primary me-2"></i>


		Tableau de Bord ‚Äî


		<span class="text-primary" id="nameCabinet"></span>


	</h4>


</div>


		<div
			class="row g-4 justify-content-center">

			<!-- üîπ 1 ‚Äî Ajouter un patient -->
			<div class="col-12 col-md-3">
				<div class="dashboard-pro position-relative">

					<div class="dashboard-pro-icon bg-success bg-opacity-10 text-success">
						<i class="bi bi-person-plus-fill"></i>
					</div>

					<h5 class="text-success">Ajouter un patient</h5>
					<p>Cr√©er une nouvelle fiche patient</p>

					<button id="addClientHome" class="btn btn-success btn-sm rounded-pill px-4 mt-2" data-bs-toggle="modal" data-bs-target="#modalAddClient">
						<i class="bi bi-plus-lg"></i>
						Ajouter
					</button>

				</div>
			</div>

			<!-- üîπ 2 ‚Äî Liste des patients -->
			<div class="col-12 col-md-3">
				<div class="dashboard-pro position-relative">

					{% if totalClients %}
						<span class="dashboard-pro-badge shadow-sm">
							{{ totalClients }}
						</span>
					{% endif %}

					<div class="dashboard-pro-icon bg-primary bg-opacity-10 text-primary">
						<i class="bi bi-people-fill"></i>
					</div>

					<h5 class="text-primary">Liste des patients</h5>
					<p>G√©rer et consulter tous les dossiers</p>

					<a href="{{ path('app_fiche_client_index') }}" class="btn btn-primary btn-sm rounded-pill px-4 mt-2">
						<i class="bi bi-search"></i>
						Patients
					</a>

				</div>
			</div>

			<!-- üîπ 3 ‚Äî M√©dicaments -->
			<div class="col-12 col-md-3">
				<div class="dashboard-pro">

					<div class="dashboard-pro-icon bg-danger bg-opacity-10 text-danger">
						<i class="bi bi-capsule-pill"></i>
					</div>

					<h5 class="text-danger">M√©dicaments</h5>
					<p>Consultation & gestion des m√©dicaments</p>

					<a href="{{ path('medicine_index') }}" class="btn btn-danger btn-sm rounded-pill px-4 mt-2">
						<i class="bi bi-prescription2"></i>
						Liste
					</a>

				</div>
			</div>

			<!-- üîπ 4 ‚Äî Rendez-vous -->
			<div class="col-12 col-md-3">
				<div class="dashboard-pro position-relative">

					{% if totalRdv %}
						<span class="dashboard-pro-badge shadow-sm">
							{{ totalRdv }}
						</span>
					{% endif %}

					<div class="dashboard-pro-icon bg-info bg-opacity-10 text-info">
						<i class="bi bi-calendar-week"></i>
					</div>

					<h5 class="text-info">Rendez-vous</h5>
					<p>Planning & gestion des consultations</p>

					<a href="{{ path('app_rdv_index') }}" class="btn btn-info btn-sm rounded-pill px-4 mt-2">
						<i class="bi bi-calendar-check"></i>
						Ouvrir
					</a>

				</div>
			</div>

		</div>


		<div class="mt-5">
			<h4 class="fw-bold mb-3">
				<i class="bi bi-ui-checks-grid text-primary me-2"></i>
				R√©f√©rentiels & Ressources
			</h4>

			<div class="row g-3">

				<a href="{{ path('hopital_search_page') }}" class="col-md-4 text-decoration-none">
					<div class="p-3 border rounded-4 shadow-sm d-flex align-items-center">
						<i class="bi bi-hospital text-primary fs-3 me-3"></i>
						<div>
							<h6 class="fw-bold mb-0">√âtablissements Hospitaliers</h6>
							<small class="text-muted">Recherche & consultation</small>
						</div>
					</div>
				</a>


				<div class="col-md-4">
					<a href="{{ path('hopital_search_page') }}" class="col-md-4 text-decoration-none">

						<div class="p-3 border rounded-4 shadow-sm d-flex align-items-center">
							<i class="bi bi-heart-pulse text-success fs-3 me-3"></i>
							<div>
								<h6 class="fw-bold mb-0">Dispositifs remboursables</h6>
								<small class="text-muted">CNOPS ‚Äì ANAM</small>
							</div>
						</div>
					</a>
				</div>

				<div class="col-md-4">
					<a href="{{ path('medicine_index') }}" class="col-md-4 text-decoration-none">


						<div class="p-3 border rounded-4 shadow-sm d-flex align-items-center">
							<i class="bi bi-capsule-pill text-danger fs-3 me-3"></i>

							<div>
								<h6 class="fw-bold mb-0">Liste des M√©dicaments</h6>

								<small class="text-muted">CNOPS ‚Äì ANAM</small>
							</div>
						</div>
					</a>


				</div>


			</div>
		</div>
		


		<!-- üìä SECTION STATISTIQUES -->
		{{ include('home/_stats/_stats.html.twig') }}


	</div>

</div>


<!-- MODAL AJOUT PATIENT -->

<div class="modal fade" id="modalAddClient" tabindex="-1">
	<div class="modal-dialog modal-xl">
		<div class="modal-content rounded-4 shadow-sm border">


			<div class="modal-header bg-primary text-white rounded-top-4">
				<h5 class="modal-title fw-bold d-flex align-items-center">
					<i class="bi bi-person-plus fs-4 me-2"></i>
					Ajouter un patient
				</h5>
				<button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
			</div>

			<div class="modal-body p-4">
				{{ include('fiche_client/new.html.twig') }}


			</div>

		</div>
	</div>
</div>


 <script>
async function afficherNomCabinet() {

    const url = "{{ path('app_nom_cabinet') }}";
const urlConfig = "{{ path('app_cabinet_index') }}"; // üîß route vers la config du cabinet


    try {
        const response = await fetch(url);
        const data = await response.json();

        console.log("Nom cabinet :", data.nom);

        const element = document.getElementById('nameCabinet');
        if (!element) return; // S√©curit√©

        // Cas o√π le nom n'est pas d√©fini
        if (!data.nom || data.nom === "null") {

            element.innerHTML = `
                Veuillez configurer le nom du cabinet 
                <a href="${urlConfig}" class="btn btn-sm btn-warning ms-2">
                    Configurer
                </a>
            `;
        } 
        else {
            // Cabinet trouv√© ‚Üí affichage normal
            element.innerText = data.nom;
        }

    } catch (error) {
        console.error("Erreur :", error);
    }
}

// Ex√©cution
afficherNomCabinet();


		



</script>{% endblock %}

